---
title: "AP_UKAlc_Exploratory_Plots"
author: "Anna Patterson"
date: "2024-01-12"
output: html_document
---



#raincloud plots on raw variables on interest from am_data
```{r}
#Alc amt - interesting
ggplot(am_data, aes(1, Alc_Amt_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())   
#Feel Drunk - potentially interesting 
ggplot(am_data, aes(1, Alc_Drunk_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())  
#Alc urge - not interesting
ggplot(am_data, aes(1, Urg_Alc_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Nic urge - not interesting
ggplot(am_data, aes(1, Urg_Nic_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Mar urge - not interesting
ggplot(am_data, aes(1, Urg_Mar_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Coc urge - not interesting 
ggplot(am_data, aes(1, Urg_Coc_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Oth urge - not interesting 
ggplot(am_data, aes(1, Urg_Oth_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Alc Crave - interesting 
ggplot(am_data, aes(1, Crav_Alc_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Mar Crave - interesting 
ggplot(am_data, aes(1, Crav_Mar_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Coc Crave - not interesting 
ggplot(am_data, aes(1, Crav_Coc_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Benz Crave - not interesting 
ggplot(am_data, aes(1, Crav_Benz_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Hall Crave - not interesting 
ggplot(am_data, aes(1, Crav_Hall_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Opiate Crav - not interesting 
ggplot(am_data, aes(1, Crav_Opiate_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
```


#Day of the week analysis 
```{r}
#weekend defined as Saturday/Sunday (so indicates amount Fri/Sat bc amts are for the night before)
am_data_weekend <- am_data %>%
  filter(wday(daterated) %in% c(1, 7))
am_data_weekday <- am_data %>%
  filter(wday(daterated) %in% c(2, 3, 4, 5, 6))
#Alc Amt
ggplot(am_data_weekend, aes(1, Alc_Amt_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(am_data_weekend, aes(1, Alc_Amt_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())
Alc_Amt_am_model_weekend <- lmer(Alc_Amt_am~ (1 | ID),
                                 data = am_data_weekend)
summary(Alc_Amt_am_model_weekend)
icc(Alc_Amt_am_model_weekend) 
ggplot(am_data_weekday, aes(1, Alc_Amt_am)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())
ggplot(am_data_weekday, aes(1, Alc_Amt_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())
Alc_Amt_am_model_weekday <- lmer(Alc_Amt_am~ (1 | ID),
                                 data = am_data_weekday)
summary(Alc_Amt_am_model_weekday)
icc(Alc_Amt_am_model_weekday) 
##alc amt stats by day of week 
#Saturday (actually indicates Friday)
am_data_Sat <- am_data %>%
  filter(wday(daterated) %in% c(7))
summary(am_data_Sat$Alc_Amt_am, na.rm =T)
#Sunday (actually indicates Saturday)
am_data_Sun <- am_data %>%
  filter(wday(daterated) %in% c(1))
summary(am_data_Sun$Alc_Amt_am, na.rm =T)
#Monday (actually indicates Sunday)
am_data_Mon <- am_data %>%
  filter(wday(daterated) %in% c(2))
summary(am_data_Mon$Alc_Amt_am, na.rm =T)
#Tuesday (actually indicates Monday)
am_data_Tues <- am_data %>%
  filter(wday(daterated) %in% c(3))
summary(am_data_Tues$Alc_Amt_am, na.rm =T)
#Wednesday (actually indicates Tuesday)
am_data_Wed <- am_data %>%
  filter(wday(daterated) %in% c(4))
summary(am_data_Wed$Alc_Amt_am, na.rm =T)
#Thursday (actually indicates Wednesday)
am_data_Thurs <- am_data %>%
  filter(wday(daterated) %in% c(5))
summary(am_data_Thurs$Alc_Amt_am, na.rm =T)
#Friday (actually indicates Thursday)
am_data_Fri <- am_data %>%
  filter(wday(daterated) %in% c(6))
summary(am_data_Fri$Alc_Amt_am, na.rm =T) 
###Plots by Day of Week 
ggplot(am_data, aes(x = factor(DayOfWeek), y = Alc_Amt_am)) +
  geom_point(position = position_jitter(width = 0.1), size = 1) +
  labs(x = "Day of the Week", y = "Number of Drinks") +
  scale_x_discrete(labels = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"))
ggplot(am_data, aes(x = factor(DayOfWeek), y = Alc_Amt_am.d)) +
  geom_boxplot() +
  labs(x = "Day of the Week", y = "Number of Drinks") +
  scale_x_discrete(labels = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"))

```
#Binge drinks per day (subtract one day for each bc surveys are filled out next day)
```{r}
#number of people who binge drank on Saturdays = 53
am_data_Sun %>% group_by(ID) %>% 
  filter(Alc_Amt_am >= 4) 
#number of people who binge drank on Sundays = 15
am_data_Mon %>% group_by(ID) %>% 
  filter(Alc_Amt_am >= 4) 
#number of people who binge drank on Mondays = 21
am_data_Tues %>% group_by(ID) %>% 
  filter(Alc_Amt_am >= 4) 
#number of people who binge drank on Tuesdays = 15
am_data_Wed %>% group_by(ID) %>% 
  filter(Alc_Amt_am >= 4) 
#number of people who binge drank on Wednesdays = 16
am_data_Thurs %>% group_by(ID) %>% 
  filter(Alc_Amt_am >= 4) 
#number of people who binge drank on Thursdays = 24
am_data_Fri %>% group_by(ID) %>% 
  filter(Alc_Amt_am >= 4) 
#number of people who binge drank on Fridays = 38
am_data_Sat %>% group_by(ID) %>% 
  filter(Alc_Amt_am >= 4) 
```

#raincloud plots on person-centered variables on interest from am_data
```{r}
#Alc amt - interesting
ggplot(am_data, aes(1, Alc_Amt_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())
#Feel Drunk - interesting 
ggplot(am_data, aes(1, Alc_Drunk_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank())   
#Alc urge - interesting
ggplot(am_data, aes(1, Urg_Alc_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Nic urge - potentially interesting
ggplot(am_data, aes(1, Urg_Nic_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Mar urge - interesting
ggplot(am_data, aes(1, Urg_Mar_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Coc urge - not interesting 
ggplot(am_data, aes(1, Urg_Coc_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Oth urge - not interesting 
ggplot(am_data, aes(1, Urg_Oth_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Alc Crave - interesting 
#Would be interesting to compare difference between crav_alc and urg_alc? 
ggplot(am_data, aes(1, Crav_Alc_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Mar Crave - interesting 
ggplot(am_data, aes(1, Crav_Mar_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Coc Crave - not interesting 
ggplot(am_data, aes(1, Crav_Coc_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Benz Crave - not interesting 
ggplot(am_data, aes(1, Crav_Benz_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Hall Crave - not interesting 
ggplot(am_data, aes(1, Crav_Hall_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
#Opiate Crav - not interesting 
ggplot(am_data, aes(1, Crav_Opiate_am.d)) +
  geom_rain() +
  theme_classic() +
  theme(axis.title.x = element_blank(), 
        axis.text.x = element_blank(), axis.ticks.x = element_blank()) 
```


## IF OUTCOME IS LINEAR, function is "lmer" not "glmer"
# rest of syntax is the same, including * for interaction and placement of random effect terms
model6 <- lmer(DMQsocial_today~legalage+age.z+covidrestrictions+
                                   currentdx_SUDalc+currentdx_SUDnonalc+frisatsun+
                                   LH_perimenstrual_count+LH_midluteal_count+LH_midfol_LH
                                 +(1+LH_midluteal_count+
                                     LH_midfol_LH+
                                     LH_perimenstrual_count | id), 
                                 control=lmerControl(optimizer="optimx",
                                                     optCtrl=list(method='nlminb')),
                                 data = etoh_data_motives)
#Create ICC for each variable that showed high variability on rainclouds from am_data 
```{r}
#calculate interclass correlations within person for each possible outcome (0 means all w/in person variance, 1 is between person variance) 
#Alc Urg ICC 0.266 
Urg_Alc_am_model <- lmer(Urg_Alc_am~ (1 | ID),
                                 data = am_data)
summary(Urg_Alc_am_model)
icc(Urg_Alc_am_model) 
#Alc Drunk ICC 0.742
Alc_Drunk_am_model <- lmer(Alc_Drunk_am~ (1 | ID),
                                 data = am_data)
summary(Alc_Drunk_am_model)
icc(Alc_Drunk_am_model) 
#Alc Crav ICC 0.617 
Crav_Alc_am_model <- lmer(Crav_Alc_am~ (1 | ID),
                                 data = am_data)
summary(Crav_Alc_am_model)
icc(Crav_Alc_am_model) 
#Alc Amt ICC 0.274
Alc_Amt_am_model <- lmer(Alc_Amt_am~ (1 | ID),
                                 data = am_data)
summary(Alc_Amt_am_model)
icc(Alc_Amt_am_model) 
#Mar crav ICC 0.741
Crav_Mar_am_model <- lmer(Crav_Mar_am~ (1 | ID),
                                 data = am_data)
summary(Crav_Mar_am_model)
icc(Crav_Mar_am_model) 

#Mar urg ICC 0.763
Urg_Mar_am_model <- lmer(Urg_Mar_am~ (1 | ID),
                                 data = am_data)
summary(Urg_Mar_am_model) 
icc(Urg_Mar_am_model) 
```

